<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
  <meta property="fb:app_id" content="1406604756269400">
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Querying Managed Meta Data fields in SharePoint 2010 | Ram Prasad Meenavalli</title>
<meta name="generator" content="Jekyll v4.1.1">
<meta property="og:title" content="Querying Managed Meta Data fields in SharePoint 2010">
<meta name="author" content="Ram Prasad">
<meta property="og:locale" content="en_US">
<meta name="description" content="I have seen many developers using the &lt;contains&gt; or &lt;eq&gt; element of CAML to query items based on a Managed Meta Data column. Using these elements of CAML for querying, returns irrelevant items in the result. Consider we have a pages library with 'Enterprise Keywords' column (OOB Site Column) in the library. Lets assume we have three pages with the Enterprise Keywords as shown in the screen below. Now if we need to fetch all the items from this library, having 'hare' or 'hares' in their 'Enterprise Keywords' column, we would end up writing a CAML query as shown below &lt;Query&gt; &lt;Where&gt; &lt;Or&gt; &lt;Contains&gt; &lt;FieldRef Name=&quot;TaxKeyword&quot; /&gt; &lt;Value Type=&quot;Text&quot;&gt;hare&lt;/Value&gt; &lt;/Contains&gt; &lt;Contains&gt; &lt;FieldRef Name=&quot;TaxKeyword&quot; /&gt; &lt;Value Type=&quot;Text&quot;&gt;hares&lt;/Value&gt; &lt;/Contains&gt; &lt;/Or&gt; &lt;/Where&gt; &lt;/Query&gt; But this query will return all the three items from the library. Ideally we should get only one item, ie., default.aspx, as only this item is having the keyword as hare. But as we are using &lt;contains&gt; in the caml query, the words 'harebell' and 'sharepoint' contains the word 'hare', so these 2 items are also returned. So, to get only the relevant items from the library, we should not use the &lt;contains&gt; element of CAML for querying Managed Meta Data columns. We have to use the WssIds of the enterprise keywords intead of the actual word. Also there is a new CAML element introduced in SharePoint 2010 - '&lt;In&gt;'. This works similar to the IN clause in a SQL query. So for the above scenario the CAML query should be as shown below &lt;Query&gt; &lt;Where&gt; &lt;In&gt; &lt;FieldRef LookupId=&quot;True&quot; Name=&quot;TaxKeyword&quot; /&gt; &lt;Values&gt; &lt;Value Type=&quot;Integer&quot;&gt;WSS ID OF KEYWORD&lt;/Value&gt; &lt;Value Type=&quot;Integer&quot;&gt;WSS ID OF KEYWORD&lt;/Value&gt; &lt;/Values&gt; &lt;/In&gt; &lt;/Where&gt; &lt;/Query&gt; How to get the WSS ID of the keyword? Get all the keywords required which are of type TaxonomyFieldValue. This class has a property called WssId (TaxonomyFieldValue.WssId) which gives the WssId of the keyword. Using this property get the WssId of each keyword and use this Id as values inside IN element of CAML. Use the below code to prepare the CAML query for querying the Managed Meta Data field String CAML_QUERY = @&quot;&lt;Where&gt;&lt;In&gt;&lt;FieldRef LookupId=&quot;&quot;True&quot;&quot; Name=&quot;&quot;TaxKeyword&quot;&quot; /&gt;&lt;Values&gt;{0}&lt;/Values&gt;&lt;/In&gt;&lt;/Where&gt;&quot;; String VALUES = @&quot;&lt;Value Type=&quot;&quot;Integer&quot;&quot;&gt;{0}&lt;/Value&gt;&quot;; StringBuilder strValues = new StringBuilder(); Literal litDisplay = new Literal(); SPListItem item = SPContext.Current.ListItem; TaxonomyFieldValueCollection keywords = (TaxonomyFieldValueCollection)item[&quot;TaxKeyword&quot;]; foreach (TaxonomyFieldValue keyword in keywords) { strValues.AppendLine(String.Format(VALUES, keyword.WssId)); } String strQuery = String.Format(CAML_QUERY, strValues.ToString()); SPQuery sPQuery = new SPQuery(); sPQuery.Query = strQuery; SPListItemCollection items = item.ParentList.GetItems(sPQuery); With the above implementation we will get only default.aspx in the result for the example scenario considered in this article (ie. default.aspx). The above code is for a webpart which is used in a page, to display all the articles having the same keywords as that of the current page. Modify the code as required based on the area you use it.">
<meta property="og:description" content="I have seen many developers using the &lt;contains&gt; or &lt;eq&gt; element of CAML to query items based on a Managed Meta Data column. Using these elements of CAML for querying, returns irrelevant items in the result. Consider we have a pages library with 'Enterprise Keywords' column (OOB Site Column) in the library. Lets assume we have three pages with the Enterprise Keywords as shown in the screen below. Now if we need to fetch all the items from this library, having 'hare' or 'hares' in their 'Enterprise Keywords' column, we would end up writing a CAML query as shown below &lt;Query&gt; &lt;Where&gt; &lt;Or&gt; &lt;Contains&gt; &lt;FieldRef Name=&quot;TaxKeyword&quot; /&gt; &lt;Value Type=&quot;Text&quot;&gt;hare&lt;/Value&gt; &lt;/Contains&gt; &lt;Contains&gt; &lt;FieldRef Name=&quot;TaxKeyword&quot; /&gt; &lt;Value Type=&quot;Text&quot;&gt;hares&lt;/Value&gt; &lt;/Contains&gt; &lt;/Or&gt; &lt;/Where&gt; &lt;/Query&gt; But this query will return all the three items from the library. Ideally we should get only one item, ie., default.aspx, as only this item is having the keyword as hare. But as we are using &lt;contains&gt; in the caml query, the words 'harebell' and 'sharepoint' contains the word 'hare', so these 2 items are also returned. So, to get only the relevant items from the library, we should not use the &lt;contains&gt; element of CAML for querying Managed Meta Data columns. We have to use the WssIds of the enterprise keywords intead of the actual word. Also there is a new CAML element introduced in SharePoint 2010 - '&lt;In&gt;'. This works similar to the IN clause in a SQL query. So for the above scenario the CAML query should be as shown below &lt;Query&gt; &lt;Where&gt; &lt;In&gt; &lt;FieldRef LookupId=&quot;True&quot; Name=&quot;TaxKeyword&quot; /&gt; &lt;Values&gt; &lt;Value Type=&quot;Integer&quot;&gt;WSS ID OF KEYWORD&lt;/Value&gt; &lt;Value Type=&quot;Integer&quot;&gt;WSS ID OF KEYWORD&lt;/Value&gt; &lt;/Values&gt; &lt;/In&gt; &lt;/Where&gt; &lt;/Query&gt; How to get the WSS ID of the keyword? Get all the keywords required which are of type TaxonomyFieldValue. This class has a property called WssId (TaxonomyFieldValue.WssId) which gives the WssId of the keyword. Using this property get the WssId of each keyword and use this Id as values inside IN element of CAML. Use the below code to prepare the CAML query for querying the Managed Meta Data field String CAML_QUERY = @&quot;&lt;Where&gt;&lt;In&gt;&lt;FieldRef LookupId=&quot;&quot;True&quot;&quot; Name=&quot;&quot;TaxKeyword&quot;&quot; /&gt;&lt;Values&gt;{0}&lt;/Values&gt;&lt;/In&gt;&lt;/Where&gt;&quot;; String VALUES = @&quot;&lt;Value Type=&quot;&quot;Integer&quot;&quot;&gt;{0}&lt;/Value&gt;&quot;; StringBuilder strValues = new StringBuilder(); Literal litDisplay = new Literal(); SPListItem item = SPContext.Current.ListItem; TaxonomyFieldValueCollection keywords = (TaxonomyFieldValueCollection)item[&quot;TaxKeyword&quot;]; foreach (TaxonomyFieldValue keyword in keywords) { strValues.AppendLine(String.Format(VALUES, keyword.WssId)); } String strQuery = String.Format(CAML_QUERY, strValues.ToString()); SPQuery sPQuery = new SPQuery(); sPQuery.Query = strQuery; SPListItemCollection items = item.ParentList.GetItems(sPQuery); With the above implementation we will get only default.aspx in the result for the example scenario considered in this article (ie. default.aspx). The above code is for a webpart which is used in a page, to display all the articles having the same keywords as that of the current page. Modify the code as required based on the area you use it.">
<link rel="canonical" href="https://blog.meenavalli.in/post/querying-managed-meta-data-fields-in-sharepoint-2010">
<meta property="og:url" content="https://blog.meenavalli.in/post/querying-managed-meta-data-fields-in-sharepoint-2010">
<meta property="og:site_name" content="Ram Prasad Meenavalli">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2011-12-08T06:30:00+00:00">
<script type="application/ld+json">
{"description":"I have seen many developers using the &lt;contains&gt; or &lt;eq&gt; element of CAML to query items based on a Managed Meta Data column. Using these elements of CAML for querying, returns irrelevant items in the result. Consider we have a pages library with &#39;Enterprise Keywords&#39; column (OOB Site Column) in the library. Lets assume we have three pages with the Enterprise Keywords as shown in the screen below. Now if we need to fetch all the items from this library, having &#39;hare&#39; or &#39;hares&#39; in their &#39;Enterprise Keywords&#39; column, we would end up writing a CAML query as shown below &lt;Query&gt; &lt;Where&gt; &lt;Or&gt; &lt;Contains&gt; &lt;FieldRef Name=&quot;TaxKeyword&quot; /&gt; &lt;Value Type=&quot;Text&quot;&gt;hare&lt;/Value&gt; &lt;/Contains&gt; &lt;Contains&gt; &lt;FieldRef Name=&quot;TaxKeyword&quot; /&gt; &lt;Value Type=&quot;Text&quot;&gt;hares&lt;/Value&gt; &lt;/Contains&gt; &lt;/Or&gt; &lt;/Where&gt; &lt;/Query&gt; But this query will return all the three items from the library. Ideally we should get only one item, ie., default.aspx, as only this item is having the keyword as hare. But as we are using &lt;contains&gt; in the caml query, the words &#39;harebell&#39; and &#39;sharepoint&#39; contains the word &#39;hare&#39;, so these 2 items are also returned. So, to get only the relevant items from the library, we should not use the &lt;contains&gt; element of CAML for querying Managed Meta Data columns. We have to use the WssIds of the enterprise keywords intead of the actual word. Also there is a new CAML element introduced in SharePoint 2010 - &#39;&lt;In&gt;&#39;. This works similar to the IN clause in a SQL query. So for the above scenario the CAML query should be as shown below &lt;Query&gt; &lt;Where&gt; &lt;In&gt; &lt;FieldRef LookupId=&quot;True&quot; Name=&quot;TaxKeyword&quot; /&gt; &lt;Values&gt; &lt;Value Type=&quot;Integer&quot;&gt;WSS ID OF KEYWORD&lt;/Value&gt; &lt;Value Type=&quot;Integer&quot;&gt;WSS ID OF KEYWORD&lt;/Value&gt; &lt;/Values&gt; &lt;/In&gt; &lt;/Where&gt; &lt;/Query&gt; How to get the WSS ID of the keyword? Get all the keywords required which are of type TaxonomyFieldValue. This class has a property called WssId (TaxonomyFieldValue.WssId) which gives the WssId of the keyword. Using this property get the WssId of each keyword and use this Id as values inside IN element of CAML. Use the below code to prepare the CAML query for querying the Managed Meta Data field String CAML_QUERY = @&quot;&lt;Where&gt;&lt;In&gt;&lt;FieldRef LookupId=&quot;&quot;True&quot;&quot; Name=&quot;&quot;TaxKeyword&quot;&quot; /&gt;&lt;Values&gt;{0}&lt;/Values&gt;&lt;/In&gt;&lt;/Where&gt;&quot;; String VALUES = @&quot;&lt;Value Type=&quot;&quot;Integer&quot;&quot;&gt;{0}&lt;/Value&gt;&quot;; StringBuilder strValues = new StringBuilder(); Literal litDisplay = new Literal(); SPListItem item = SPContext.Current.ListItem; TaxonomyFieldValueCollection keywords = (TaxonomyFieldValueCollection)item[&quot;TaxKeyword&quot;]; foreach (TaxonomyFieldValue keyword in keywords) { strValues.AppendLine(String.Format(VALUES, keyword.WssId)); } String strQuery = String.Format(CAML_QUERY, strValues.ToString()); SPQuery sPQuery = new SPQuery(); sPQuery.Query = strQuery; SPListItemCollection items = item.ParentList.GetItems(sPQuery); With the above implementation we will get only default.aspx in the result for the example scenario considered in this article (ie. default.aspx). The above code is for a webpart which is used in a page, to display all the articles having the same keywords as that of the current page. Modify the code as required based on the area you use it.","url":"https://blog.meenavalli.in/post/querying-managed-meta-data-fields-in-sharepoint-2010","@type":"BlogPosting","headline":"Querying Managed Meta Data fields in SharePoint 2010","dateModified":"2011-12-08T06:30:00+00:00","datePublished":"2011-12-08T06:30:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.meenavalli.in/post/querying-managed-meta-data-fields-in-sharepoint-2010"},"author":{"@type":"Person","name":"Ram Prasad"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="/assets/images/Ram.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
  <!-- and it's easy to individually load additional languages -->
  <script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="https://blog.meenavalli.in/feed.xml" title="Ram Prasad Meenavalli">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body>



















<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <!-- <img class="site-favicon" title="Ram Prasad Meenavalli" src="/assets/images/Ram.png" onerror="this.style.display='none'"> -->
  Ram Prasad Meenavalli
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/">HOME</a><a class="page-link" href="/talks.html">PUBLIC TALKS</a>




</div>
        </nav>
</div>
  </div>
</header>

<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  })();
</script>










































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.matches('a')) {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">Querying Managed Meta Data fields in SharePoint 2010</h1>
  <h3 class="post-subtitle"></h3>

  <div class="post-meta">
    <time class="dt-published" datetime="2011-12-08T06:30:00+00:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Dec 8, 2011
    </time>

    





















    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 3 mins</span><div id="social-icons">
    <!-- Twitter button -->
    <div id="twitter-button">
    <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Querying+Managed+Meta+Data+fields+in+SharePoint+2010&amp;url=https%3A%2F%2Fblog.meenavalli.in%2Fpost%2Fquerying-managed-meta-data-fields-in-sharepoint-2010&amp;hashtags=SharePointOnline,SharePointServer,SharePoint2010,SharePoint2013,SharePoint2016,SharePoint2019&amp;via=ram_meenavalli">Tweet</a>

    </div>
    <!--End of twitter button code--> 

    <!--Linkedin share button-->
    <script type="IN/Share" data-url="https://blog.meenavalli.in/post/querying-managed-meta-data-fields-in-sharepoint-2010"></script>
    <!--End of Linkedin share button-->

    <!--Facebook share button-->
    <div id="fb-root" style="display:inline-block"></div>
    <div style="display:inline-block" class="fb-share-button" data-href="https://blog.meenavalli.in/post/querying-managed-meta-data-fields-in-sharepoint-2010" data-layout="button" data-size="small"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.meenavalli.in%2Fpost%2Fquerying-managed-meta-data-fields-in-sharepoint-2010&src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div>
    <!--End of facebook share button-->

    <!--Facebook page like button-->
    <div style="top:8px" class="fb-like" data-href="https://www.facebook.com/rammeenavalli" data-width="" data-layout="button_count" data-action="like" data-size="small" data-share="false"></div>
    <!--End of facebook page like button-->
</div>
</div>
<div class="post-tags">
<a class="post-tag" href="/tags.html#SharePoint%20Online">#SharePoint Online</a><a class="post-tag" href="/tags.html#SharePoint%20Server">#SharePoint Server</a><a class="post-tag" href="/tags.html#SharePoint%202010">#SharePoint 2010</a><a class="post-tag" href="/tags.html#SharePoint%202013">#SharePoint 2013</a><a class="post-tag" href="/tags.html#SharePoint%202016">#SharePoint 2016</a><a class="post-tag" href="/tags.html#SharePoint%202019">#SharePoint 2019</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <!-- more -->

<p>I have seen many developers using the &lt;contains&gt; or &lt;eq&gt; element of CAML to query items based on a Managed Meta Data column. Using these elements of CAML for querying, returns irrelevant items in the result.</p>
<p>Consider we have a pages library with 'Enterprise Keywords' column (OOB Site Column) in the library. Lets assume we have three pages with the Enterprise Keywords as shown in the screen below.</p>
<p><img src="/assets/images/query_mms.png" alt=""></p>
<p>Now if we need to fetch all the items from this library, having '<em>hare</em>' or '<em>hares</em>' in their 'Enterprise Keywords' column, we would end up writing a CAML query as shown below</p>
<pre class="brush:xml;auto-links:false;toolbar:false" contenteditable="false">&lt;Query&gt;
    &lt;Where&gt;
        &lt;Or&gt;
            &lt;Contains&gt;
                &lt;FieldRef Name="TaxKeyword" /&gt;
                &lt;Value Type="Text"&gt;hare&lt;/Value&gt;
            &lt;/Contains&gt;
            &lt;Contains&gt;
                &lt;FieldRef Name="TaxKeyword" /&gt;
                &lt;Value Type="Text"&gt;hares&lt;/Value&gt;
            &lt;/Contains&gt;
        &lt;/Or&gt;
    &lt;/Where&gt;
&lt;/Query&gt;</pre>
<p>But this query will return all the three items from the library. Ideally we should get only one item, ie., default.aspx, as only this item is having the keyword as hare. But as we are using &lt;contains&gt; in the caml query, the words '<em>harebell</em>' and '<em>sharepoint</em>' contains the word '<em>hare</em>', so these 2 items are also returned. </p>
<p>So, to get only the relevant items from the library, we should not use the &lt;contains&gt; element of CAML for querying Managed Meta Data columns. We have to use the <strong><em>WssIds</em></strong> of the enterprise keywords intead of the actual word. Also there is a new CAML element introduced in SharePoint 2010 - '<em><strong>&lt;In&gt;</strong></em>'. This works similar to the IN clause in a SQL query. So for the above scenario the CAML query should be as shown below</p>
<pre class="brush:xml;auto-links:false;toolbar:false" contenteditable="false">&lt;Query&gt;
    &lt;Where&gt;
        &lt;In&gt;
            &lt;FieldRef LookupId="True" Name="TaxKeyword" /&gt;
            &lt;Values&gt;
                &lt;Value Type="Integer"&gt;WSS ID OF KEYWORD&lt;/Value&gt;
                &lt;Value Type="Integer"&gt;WSS ID OF KEYWORD&lt;/Value&gt;
            &lt;/Values&gt;
        &lt;/In&gt;
    &lt;/Where&gt;
&lt;/Query&gt;</pre>
<p>How to get the WSS ID of the keyword?<br> Get all the keywords required which are of type TaxonomyFieldValue. This class has a property called WssId (TaxonomyFieldValue.WssId) which gives the WssId of the keyword. Using this property get the WssId of each keyword and use this Id as values inside IN element of CAML. </p>
<p>Use the below code to prepare the CAML query for querying the Managed Meta Data field</p>
<pre class="brush:xml;auto-links:false;toolbar:false" contenteditable="false">String CAML_QUERY = @"&lt;Where&gt;&lt;In&gt;&lt;FieldRef LookupId=""True"" Name=""TaxKeyword"" /&gt;&lt;Values&gt;{0}&lt;/Values&gt;&lt;/In&gt;&lt;/Where&gt;";
String VALUES = @"&lt;Value Type=""Integer""&gt;{0}&lt;/Value&gt;";

StringBuilder strValues = new StringBuilder();
Literal litDisplay = new Literal();

SPListItem item = SPContext.Current.ListItem;
TaxonomyFieldValueCollection keywords = (TaxonomyFieldValueCollection)item["TaxKeyword"];

foreach (TaxonomyFieldValue keyword in keywords)
{
    strValues.AppendLine(String.Format(VALUES, keyword.WssId));
}

String strQuery = String.Format(CAML_QUERY, strValues.ToString());

SPQuery sPQuery = new SPQuery();
sPQuery.Query = strQuery;

SPListItemCollection items = item.ParentList.GetItems(sPQuery);</pre>
<p>With the above implementation we will get only default.aspx in the result for the example scenario considered in this article (ie. default.aspx). The above code is for a webpart which is used in a page, to display all the articles having the same keywords as that of the current page. Modify the code as required based on the area you use it.</p>


    </div>

</article><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7825254818219233" data-ad-slot="2526456411"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script><div class="post-nav">
<a class="previous" href="/post/custom-error-pages-for-sharepoint-server-sites" title="Mapping Custom Error Pages for SharePoint Server Sites">Mapping Custom Error Pages for SharePoint...</a><a class="next" href="/post/open-tool-pane-link-in-a-custom-webpart" title="'Open Tool Pane' link in a custom webpart">'Open Tool Pane' link in a...</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/post/c-net-client-api-code-snippet-to-search-query-for-people-in-sharepoint-server-2013-2016" title="'Open Tool Pane' link in a custom webpart">C# .NET Client API code snippet to search/query for people in SharePoint...</a></li>
<li><a class="post-link" href="/post/adding-custom-font-styles-to-sharepoint-server-rich-text-editors" title="'Open Tool Pane' link in a custom webpart">Adding Custom Font Styles to SharePoint Server Rich Text Editors</a></li>
<li><a class="post-link" href="/post/SharePoint-PropertyOrFieldNotInitializedException-CSOM-ClientContext" title="'Open Tool Pane' link in a custom webpart">PropertyOrFieldNotInitializedException when using .NET Client Object Model for SharePoint Server 2013</a></li>
<li><a class="post-link" href="/post/developer-dashboard-in-sharepoint-2010" title="'Open Tool Pane' link in a custom webpart">Developer Dashboard in SharePoint 2010</a></li>
</ul>
    </div>
<div class="post-comments"></div>
<div class="fb-comments" data-mobile data-width="100%" data-href="https://blog.meenavalli.in/post/querying-managed-meta-data-fields-in-sharepoint-2010" data-numposts="5"></div>
  </section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><header class="author-bio">
    <div class="blog-info">
        <a class="blog-logo" href="https://meenavalli.in" tabindex="-1" target="_blank">
            <img src="/assets/images/Ram.png" alt="Ram Prasad">
            Ram Prasad
        </a>
        <div class="blog-author">
            Developer | Office 365 | SharePoint | Blogger | Speaker
        </div>
        <ul class="social-network">
            <li style="display: inline-block;"><a href="https://www.facebook.com/ramprasad.meenavalli" rel="external nofollow"><i class="fa fa-facebook"></i></a></li>
            <li style="display: inline-block;"><a href="https://twitter.com/ram_meenavalli" rel="external nofollow"><i class="fa fa-twitter"></i></a></li>
            <li style="display: inline-block;"><a href="https://www.linkedin.com/in/ramprasadmeenavalli/" rel="external nofollow"><i class="fa fa-linkedin"></i></a></li>
            <li style="display: inline-block;"><a href="https://www.youtube.com/channel/UCBp4idRQxYfnJTPugX40dwg" rel="external nofollow"><i class="fa fa-youtube"></i></a></li>
            <li style="display: inline-block;"><a href="https://github.com/RamPrasadMeenavalli" rel="external nofollow"><i class="fa fa-git"></i></a></li>
        </ul>
    </div>
</header><!--Add a square ad-->
<div class="sidebar-box">
<!-- display-square -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7825254818219233" data-ad-slot="6472568147" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
      <div>Copyright © 2011-2021</div>
      <div>Customized &amp; redesigned from <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>

<script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
</script>



<script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>

<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&amp;version=v8.0&amp;appId=1406604756269400&amp;autoLogAppEvents=1" nonce="LgzoCMCm"></script>
</body>
</html>
